<!DOCTYPE html>
<html lang="en">
<head>
    <title>Order and payment</title>

    <style>
        html, body {
            height: 100%;
            margin: 0;
        }

        body {
            font-family: Arial;
            display: flex;
            flex-direction: column;
        }

        .content {
            flex: 1;
            margin: 40px;
        }

        .top-section {
            display: flex;
            gap: 40px;
            align-items: flex-start;
        }

        table {
            margin-top: 20px;
            border-collapse: collapse;
        }

        td, th {
            padding: 8px;
            border: 1px solid black;
        }

        input, select {
            padding: 6px;
        }

        button {
            padding: 10px 20px;
            margin-top: 15px;
        }

        .result {
            font-weight: bold;
            margin-top: 20px;
        }

        .success { color: green; }
        .error { color: red; }

        #cardIcon {
            font-size: 18px;
            margin-left: 8px;
            font-weight: bold;
        }

        .valid-check { color: green; }
        .invalid-check { color: red; }

        footer {
            background-color: #2e7d32;
            color: white;
            text-align: center;
            padding: 15px;
            font-weight: bold;
        }
    </style>
</head>

<body>

<div class="content">

<h1>E-Commerce Order and Payment</h1>

<h2>Order Details</h2>

<div class="top-section">

    <!-- Current Order Table -->
    <table>
        <tr>
            <td><strong>Order ID</strong></td>
            <td>
                <input type="text" id="orderId"
                       maxlength="10"
                       placeholder="Max 10 characters"
                       required>
            </td>
        </tr>

        <tr>
            <td><strong>Price ($)</strong></td>
            <td><input type="number" id="price" readonly></td>
        </tr>

        <tr>
            <td><strong>Total ($)</strong></td>
            <td><input type="number" id="total" readonly></td>
        </tr>
    </table>

    <!-- Stored Orders Table (VISUAL ONLY) -->
    <table id="storedOrdersTable">
        <tr>
            <th>Order ID</th>
            <th>Price</th>
            <th>Total</th>
        </tr>
    </table>

</div>

<button onclick="generateOrderData()">Generate Random Order</button>

<h2>Customer Information</h2>

<table>
    <tr>
        <td>First Name</td>
        <td><input type="text" id="firstName" required></td>
    </tr>
    <tr>
        <td>Last Name</td>
        <td><input type="text" id="lastName" required></td>
    </tr>
    <tr>
        <td>Address</td>
        <td><input type="text" id="address" size="40" required></td>
    </tr>
</table>

<h2>Card Details</h2>

<table>

    <tr>
        <td>Card Type</td>
        <td>
            <select id="cardType" required>
                <option value="">Select Card Type</option>
                <option value="visa">Visa</option>
                <option value="mastercard">MasterCard</option>
                <option value="amex">American Express</option>
                <option value="discover">Discover</option>
            </select>
        </td>
    </tr>

    <tr>
        <td>Name on Card</td>
        <td><input type="text" id="cardName" maxlength="50"></td>
    </tr>

    <tr>
        <td>Card Number</td>
        <td>
            <input type="text"
                   id="cardNumber"
                   maxlength="16"
                   placeholder="16-digit card number"
                   oninput="validateCardNumber(this)">
            <span id="cardIcon"></span>
        </td>
    </tr>

    <tr>
        <td>Expiration (MM/YY)</td>
        <td>
            <input type="text"
                   id="expiryDate"
                   maxlength="5"
                   placeholder="MM/YY"
                   oninput="formatExpiry(this)">
        </td>
    </tr>

    <tr>
        <td>CVV</td>
        <td>
            <input type="password"
                   id="cvv"
                   maxlength="4"
                   pattern="[0-9]{3,4}">
        </td>
    </tr>

    <tr>
        <td>Billing Zip Code</td>
        <td>
            <input type="text"
                   id="zipcode"
                   maxlength="5"
                   placeholder="5-digit ZIP">
        </td>
    </tr>

    <tr>
        <td>Payment Amount ($)</td>
        <td>
            <input type="number"
                   id="amount"
                   step="0.01"
                   readonly>
        </td>
    </tr>

    <tr>
        <td colspan="2">
            <button onclick="submitPayment()">Submit Payment</button>
        </td>
    </tr>

</table>

<div id="result" class="result"></div>

</div>

<footer>
    <p>Team 10 | Integration With Payment Provider</p>
</footer>

<script>

/* ===============================
   GENERATE RANDOM ORDER DATA
=================================*/
function generateOrderData() {

    const randomOrderId = "ORD" + Math.random()
        .toString(36)
        .substring(2,7)
        .toUpperCase();

    const price = (Math.random() * 490 + 10).toFixed(2);
    const total = (price * 1.10).toFixed(2);

    document.getElementById("orderId").value = randomOrderId;
    document.getElementById("price").value = price;
    document.getElementById("total").value = total;

    // Auto-set payment amount to total
    document.getElementById("amount").value = total;

    // Visual only
    const table = document.getElementById("storedOrdersTable");
    const row = table.insertRow();
    row.insertCell(0).innerHTML = randomOrderId;
    row.insertCell(1).innerHTML = "$" + price;
    row.insertCell(2).innerHTML = "$" + total;
}

/* ===============================
   FORMAT EXPIRY MM/YY
=================================*/
function formatExpiry(input) {
    let value = input.value.replace(/\D/g, '');
    if (value.length >= 3) {
        input.value = value.substring(0,2) + "/" + value.substring(2,4);
    } else {
        input.value = value;
    }
}

/* ===============================
   CARD VALIDATION
=================================*/
function validateCardNumber(input) {
    input.value = input.value.replace(/\D/g, '');
    const icon = document.getElementById("cardIcon");

    if(input.value.length === 16) {
        icon.innerHTML = "✔";
        icon.className = "valid-check";
        return true;
    } else {
        icon.innerHTML = "✖";
        icon.className = "invalid-check";
        return false;
    }
}

/* ===============================
   EXPIRATION VALIDATION
=================================*/
function validateExpiration() {
    const expiry = document.getElementById("expiryDate").value;
    const parts = expiry.split("/");
    if(parts.length !== 2) return false;

    const month = parseInt(parts[0]);
    const year = parseInt("20" + parts[1]);

    const today = new Date();
    const expDate = new Date(year, month);

    return expDate > today;
}

/* ===============================
   ZIP VALIDATION
=================================*/
function validateZip() {
    const zip = document.getElementById("zipcode").value;
    return /^[0-9]{5}$/.test(zip);
}

/* ===============================
   MASK CARD NUMBER
=================================*/
function maskCardNumber(cardNumber) {
    const cleaned = cardNumber.replace(/\D/g, "");
    const last4 = cleaned.slice(-4);
    return "**** **** **** " + last4;
}

/* ===============================
   SUBMIT PAYMENT
   (USES ONLY ORDER DETAILS SECTION)
=================================*/
function submitPayment() {

    const result = document.getElementById("result");

    const orderId = document.getElementById("orderId").value.trim();
    const total = parseFloat(document.getElementById("total").value);
    const paymentAmount = parseFloat(document.getElementById("amount").value);

    if (!orderId) {
        result.innerHTML = "Order ID is required ✖";
        result.className = "result error";
        return;
    }

    if (paymentAmount !== total) {
        result.innerHTML = "Payment amount mismatch ✖";
        result.className = "result error";
        return;
    }

    if (!validateCardNumber(document.getElementById("cardNumber"))) {
        result.innerHTML = "Invalid card number ✖";
        result.className = "result error";
        return;
    }

    if (!validateExpiration()) {
        result.innerHTML = "Card is expired ✖";
        result.className = "result error";
        return;
    }

    if (!validateZip()) {
        result.innerHTML = "Invalid ZIP Code ✖";
        result.className = "result error";
        return;
    }

    const maskedCard = maskCardNumber(
        document.getElementById("cardNumber").value
    );

    result.innerHTML =
        "Payment Approved ✔<br>" +
        "Order ID: " + orderId + "<br>" +
        "Charged: $" + total.toFixed(2) + "<br>" +
        "Masked Card: " + maskedCard;

    result.className = "result success";
}

</script>

</body>
</html>



